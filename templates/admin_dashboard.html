<!DOCTYPE html>
<html>
<head>
  <title>ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 2em;
      background-color: #f9f9f9;
    }
    .header-section {
      background-color: white;
      padding: 1.5em;
      margin-bottom: 1em;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .action-buttons {
      margin: 1em 0;
    }
    .action-buttons button, .action-buttons a {
      background-color: #007bff;
      color: white;
      padding: 0.5em 1em;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
      margin-right: 0.5em;
      margin-bottom: 0.5em;
    }
    .action-buttons button:hover, .action-buttons a:hover {
      background-color: #0056b3;
    }
    .import-button {
      background-color: #28a745 !important;
    }
    .import-button:hover {
      background-color: #218838 !important;
    }
    .participant-list {
      background-color: white;
      padding: 1.5em;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      overflow-x: auto;
    }
    .stats {
      background-color: #d4edda;
      padding: 1em;
      border-radius: 4px;
      margin: 1em 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1em;
    }
    th {
      background-color: #007bff;
      color: white;
      padding: 0.75em;
      text-align: left;
      border: 1px solid #dee2e6;
    }
    td {
      padding: 0.5em;
      border: 1px solid #dee2e6;
    }
    tr:hover {
      background-color: #f8f9fa;
    }
    .flash-messages {
      margin-bottom: 1em;
    }
    .flash {
      padding: 1em;
      margin-bottom: 1em;
      border-radius: 4px;
    }
    .flash.error {
      background-color: #f8d7da;
      border: 1px solid #f5c6cb;
      color: #721c24;
    }
    .flash.success {
      background-color: #d4edda;
      border: 1px solid #c3e6cb;
      color: #155724;
    }
  </style>
</head>
<body>
  <!-- Flashãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="flash-messages">
        {% for category, message in messages %}
          <div class="flash {{ category if category else 'info' }}">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <div class="header-section">
    <h1>ğŸ“Š ç®¡ç†è€…ãƒšãƒ¼ã‚¸</h1>
    
    <div class="stats">
      <h3>ğŸ“ˆ çµ±è¨ˆæƒ…å ±</h3>
      <p><strong>AGMå‡ºå¸­è€…: {{ agm_count }}äºº</strong></p>
      <p style="margin-left: 2em;">â”” å‡ºå¸­ï¼ˆå¯¾é¢ï¼‰: {{ agm_present_inperson }}äºº</p>
      <p style="margin-left: 2em;">â”” å‡ºå¸­ï¼ˆã‚ªãƒ³ãƒ©ã‚¤ãƒ³ï¼‰: {{ agm_present_online }}äºº</p>
      <p><strong>LPACå‡ºå¸­è€…: {{ lpac_count }}äºº</strong></p>
      <p style="margin-left: 2em;">â”” å‡ºå¸­ï¼ˆå¯¾é¢ï¼‰: {{ lpac_present_inperson }}äºº</p>
      <p style="margin-left: 2em;">â”” å‡ºå¸­ï¼ˆã‚ªãƒ³ãƒ©ã‚¤ãƒ³ï¼‰: {{ lpac_present_online }}äºº</p>
      <p>å…¨å‚åŠ è€…æ•°: {{ participants|length }}äºº</p>
    </div>

    <div class="action-buttons">
      <h3>ğŸ”§ ç®¡ç†æ©Ÿèƒ½</h3>
      <a href="{{ url_for('download_csv') }}">
        <button type="button">ğŸ“¥ å‚åŠ è€…ä¸€è¦§ã‚’CSVå‡ºåŠ›</button>
      </a>
      <a href="{{ url_for('import_csv') }}" class="import-button">
        ğŸ“¤ å‚åŠ è€…CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆ
      </a>
      <a href="{{ url_for('import_users') }}" class="import-button">
        ğŸ‘¥ ãƒ¦ãƒ¼ã‚¶ãƒ¼CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆ
      </a>
    </div>
  </div>

  <div class="participant-list">
    <h2>ğŸ‘¤ å‚åŠ è€…ä¸€è¦§</h2>
    {% if participants %}
      <table>
        <thead>
          <tr>
            <th>ãƒ¦ãƒ¼ã‚¶ãƒ¼å</th>
            <th>å½¹è·</th>
            <th>åå‰</th>
            <th>ãƒ¡ãƒ¼ãƒ«</th>
            <th>AGMã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
            <th>LPACã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
            <th>è³ªå•</th>
          </tr>
        </thead>
        <tbody>
          {% for p in participants %}
            <tr>
              <td>{{ p.user.username }}</td>
              <td>{{ p.position }}</td>
              <td>{{ p.name }}</td>
              <td>{{ p.email }}</td>
              <td>{{ p.agm_status or 'æœªè¨­å®š' }}</td>
              <td>{{ p.lpac_status or 'æœªè¨­å®š' }}</td>
              <td>{{ p.questions or 'ï¼ˆè³ªå•ãªã—ï¼‰' }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p>å‚åŠ è€…ã¯ã¾ã ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
    {% endif %}
  </div>

  <div style="margin-top: 2em;">
    <a href="{{ url_for('index') }}">â† ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a> | 
    <a href="{{ url_for('logout') }}">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</a>
  </div>
</body>
</html>
